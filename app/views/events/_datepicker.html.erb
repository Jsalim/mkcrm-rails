<script>
	$(function() {	
		var dates = $("#event_start_at, #event_end_at").datepicker({
			dateFormat: 'dd/mm/yy',
			defaultDate: "+1w",
			changeMonth: false,
			changeYear: false,
			numberOfMonths: 2,
			onKeyUp: function() {
				this.value = this.value.replace(/[^0-9\/]/g,''); 	
			},
			onSelect: function( selectedDate ) {
				var option = this.id == "event_start_at" ? "minDate" : "maxDate",
					instance = $( this ).data( "datepicker" ),
					date = $.datepicker.parseDate(
						instance.settings.dateFormat ||
						$.datepicker._defaults.dateFormat,
						selectedDate, instance.settings );
				dates.not( this ).datepicker( "option", option, date );
				
				$("#" + this.id + "_1i").val(date.getFullYear());
				$("#" + this.id + "_2i").val(date.getMonth()+1);
				$("#" + this.id + "_3i").val(date.getDate());
			}
		});
				
		var updateFields = function() {
			var selectedDate = $( "#event_start_at" ).val();
			var option = "minDate",
				instance = $( "#event_start_at" ).data( "datepicker" ),
				date = $.datepicker.parseDate(
					instance.settings.dateFormat ||
					$.datepicker._defaults.dateFormat,
					selectedDate, instance.settings );
			dates.not( "#event_start_at" ).datepicker( "option", option, date );
			
			$("#event_start_at" + "_1i").val(date.getFullYear());
			$("#event_start_at" + "_2i").val(date.getMonth()+1);
			$("#event_start_at" + "_3i").val(date.getDate());
			
			selectedDate = $( "#event_end_at" ).val();
			option = "maxDate",
				instance = $( "#event_end_at" ).data( "datepicker" ),
				date = $.datepicker.parseDate(
					instance.settings.dateFormat ||
					$.datepicker._defaults.dateFormat,
					selectedDate, instance.settings );
			dates.not( "#event_end_at" ).datepicker( "option", option, date );
			
			$("#event_end_at" + "_1i").val(date.getFullYear());
			$("#event_end_at" + "_2i").val(date.getMonth()+1);
			$("#event_end_at" + "_3i").val(date.getDate());
			
		};
		
		$('.datepicker').change( updateFields );
		$('form').submit( updateFields );
	});
</script>